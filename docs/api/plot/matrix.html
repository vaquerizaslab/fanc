<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matrix plots &mdash; FAN-C 0.9.26b1-beta documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Region and score plots" href="region.html" />
    <link rel="prev" title="Plotting API basics" href="plot_basics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> FAN-C
          </a>
              <div class="version">
                0.9.26b1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started with FAN-C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fanc.html">fanc: command line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fancplot.html">fancplot: plotting from the command line</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html">Working with Juicer and Cooler files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interfaces.html">Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generate.html">Generate Hi-C matrices (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyse.html">Analyse Hi-C matrices (API)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../plot.html">Plotting (API)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_basics.html">Plotting basics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Matrix plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#square-matrix">Square matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triangular-matrix">Triangular matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#split-matrix">Split matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mirrored-plot">Mirrored plot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="region.html">Region and score plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html">Reference</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">FAN-C</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">fanc Python module</a> &raquo;</li>
          <li><a href="../plot.html">Plotting (API)</a> &raquo;</li>
      <li>Matrix plots</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/plot/matrix.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="matrix-plots">
<span id="api-plot-matrix"></span><h1>Matrix plots<a class="headerlink" href="#matrix-plots" title="Permalink to this heading"></a></h1>
<p>After importing <code class="docutils literal notranslate"><span class="pre">fanc.plotting</span></code> as <code class="docutils literal notranslate"><span class="pre">fancplot</span></code>, we have access to a range of Hi-C (and related)
matrix plots. We already used the <code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularHicPlot</span></code> as an example in
<a class="reference internal" href="plot_basics.html#api-plot-basics"><span class="std std-ref">Plotting API basics</span></a>. In total there are four types of matrix visualisation built in to FAN-C:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SquareHicPlot</span></code>, which shows a square matrix, with colors typically
representing contact strength between the two genomic regions on the X, and Y axes, respectively.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularHicPlot</span></code>, which rotates the matrix by 45 degrees, so
instead of a square, it now becomes a triangle. This can be particularly useful if features close to
the matrix diagonal, such as TADs, are of interest, and if additional genomic tracks, such as CTCF
binding, should be shown underneath</p></li>
<li><p><a class="reference internal" href="../modules/plotting.html#fanc.plotting.SplitMatrixPlot" title="fanc.plotting.hic_plotter.SplitMatrixPlot"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplitMatrixPlot</span></code></a>, which is similar to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">SquareHicPlot</span></code>, but the values above and below the diagonal
are from different matrices. This is a great way for direct matrix feature comparisons in the same
plot.</p></li>
<li><p><a class="reference internal" href="../modules/plotting.html#fanc.plotting.MirrorMatrixPlot" title="fanc.plotting.plotter.MirrorMatrixPlot"><code class="xref py py-class docutils literal notranslate"><span class="pre">MirrorMatrixPlot</span></code></a>, which can be used to show two matrix plots,
particularly of the type <code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularHicPlot</span></code>, mirrored at the
X axis</p></li>
</ul>
<p>All of these are built on the base class <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePlotterMatrix</span></code>, so
they share of lot of options and functionality. Let’s look at each of them in turn.</p>
<section id="square-matrix">
<h2>Square matrix<a class="headerlink" href="#square-matrix" title="Permalink to this heading"></a></h2>
<p>To generate a basic square matrix plot, run</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">SquareMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_square.png" src="../../_images/plot_square.png" />
<p>Currently, the diagonal is about the only thing visible in this example, so let’s adjust the saturation
of the plot with <code class="docutils literal notranslate"><span class="pre">vmax</span></code> (<code class="docutils literal notranslate"><span class="pre">vmin</span></code> can be used to set a lower bound)</p>
<p>To generate a basic square matrix plot, run</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">SquareMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_square_vmax.png" src="../../_images/plot_square_vmax.png" />
<p>FAN-C uses the custom “germany” colormap as a default, built using the
<a class="reference external" href="https://github.com/bids/colormap">colormap scripts</a> from Stéfan van der Walt and Nathaniel Smith,
which have also been used to generate the default matplotlib colormaps. It is “perceptually uniform”,
and thus well-suited to represent contact intensities. We are also including a colormap called
“white_red”, for a more classic Hi-C matrix look, but equally perceptually uniform:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">SquareMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;white_red&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_square_cmap.png" src="../../_images/plot_square_cmap.png" />
<p>Any <a class="reference external" href="https://matplotlib.org/3.1.1/gallery/color/colormap_reference.html">Matplotlib-compatible colormap</a>
can be used to change the look of your matrix. You can remove the colorbar, for example if you want to
add your own on a different axis, using <code class="docutils literal notranslate"><span class="pre">show_colorbar=False</span></code>. Alternatively, if you have set up your
<a class="reference internal" href="plot_basics.html#api-plot-matplotlib"><span class="std std-ref">axes manually</span></a>, you can move the colorbar to an axis of your choice using
<code class="docutils literal notranslate"><span class="pre">cax=&lt;your</span> <span class="pre">axis&gt;</span></code> in the constructor.</p>
<p>The exponential decay of contact intensities with distance between any two loci can sometimes make
it difficult to visualise features close to the diagonal and far fro it simultaneously. Sometimes
showing colors on a log scale can improve this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">SquareMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_square_log.png" src="../../_images/plot_square_log.png" />
<p>You can show uncorrected values using <code class="docutils literal notranslate"><span class="pre">matrix_norm=False</span></code> (note the color scale change):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">SquareMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">matrix_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_square_uncorrected.png" src="../../_images/plot_square_uncorrected.png" />
<p>We can also show log2 observed/expected values using <code class="docutils literal notranslate"><span class="pre">oe=True</span></code> and <code class="docutils literal notranslate"><span class="pre">log=True</span></code> When not setting the
colorbar limit explicitly, you can also make the colorbar symmetrical around 0 using <code class="docutils literal notranslate"><span class="pre">colorbar_symmetry=0</span></code>.
We will also use a divergent colormap:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">SquareMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">oe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_square_oe.png" src="../../_images/plot_square_oe.png" />
</section>
<section id="triangular-matrix">
<h2>Triangular matrix<a class="headerlink" href="#triangular-matrix" title="Permalink to this heading"></a></h2>
<p>Any of the above customisations also work for the triangular version of the matrix plot,
<code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularHicPlot</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">TriangularMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_triangular.png" src="../../_images/plot_triangular.png" />
<p>Additionally, we can control the height, at which the triangle is cut off, and therefore
the maximum distance at which contacts are shown between two regions, with <code class="docutils literal notranslate"><span class="pre">max_dist</span></code>.
This value is expressed in base pairs, but supports strings in genomic format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">TriangularMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="s1">&#39;2mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_triangular_maxdist.png" src="../../_images/plot_triangular_maxdist.png" />
</section>
<section id="split-matrix">
<h2>Split matrix<a class="headerlink" href="#split-matrix" title="Permalink to this heading"></a></h2>
<p>The <a class="reference internal" href="../modules/plotting.html#fanc.plotting.SplitMatrixPlot" title="fanc.plotting.hic_plotter.SplitMatrixPlot"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplitMatrixPlot</span></code></a> requires two Hi-C objects, one for
above, and one for below the diagonal. Unless you explicitly set <code class="docutils literal notranslate"><span class="pre">scale_matrices</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>,
the plot will first scale both matrices to the same sequencing depth, in order to make them
more comparable. Depending on your normalisation, this may not be necessary.</p>
</section>
<section id="mirrored-plot">
<h2>Mirrored plot<a class="headerlink" href="#mirrored-plot" title="Permalink to this heading"></a></h2>
<p>To showcase the <a class="reference internal" href="../modules/plotting.html#fanc.plotting.MirrorMatrixPlot" title="fanc.plotting.plotter.MirrorMatrixPlot"><code class="xref py py-class docutils literal notranslate"><span class="pre">MirrorMatrixPlot</span></code></a>, we can plot the Hi-C matrix,
and its O/E transformation at the same time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># first create two triangular plots</span>
<span class="n">top_plot</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">TriangularMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="s1">&#39;2mb&#39;</span><span class="p">)</span>
<span class="n">bottom_plot</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">TriangularMatrixPlot</span><span class="p">(</span><span class="n">hic</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">oe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="s1">&#39;2mb&#39;</span><span class="p">)</span>
<span class="c1"># then merge them</span>
<span class="n">hp</span> <span class="o">=</span> <span class="n">fancplot</span><span class="o">.</span><span class="n">MirrorMatrixPlot</span><span class="p">(</span><span class="n">top_plot</span><span class="p">,</span> <span class="n">bottom_plot</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;chr18:6mb-10mb&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/plot_mirror.png" src="../../_images/plot_mirror.png" />
<p>Opposed to Split matrix, it is also possible to combine matrices of different resolution, or
from different Hi-C experiments, as long as they are from the same organism.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_basics.html" class="btn btn-neutral float-left" title="Plotting API basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="region.html" class="btn btn-neutral float-right" title="Region and score plots" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Kai Kruse, Vaquerizas lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>